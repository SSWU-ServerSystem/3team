<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>예약 페이지</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .header {
            background-color: #d8cef6;
            padding: 10px;
            text-align: center;
            font-size: 20px;
            color: black;
            margin-left: 250px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .sidebar {
            width: 250px;
            background-color: #FFFFFF;
            position: fixed;
            height: 100%;
            border: 1px solid #d3d3d3;
        }
        .sidebar a {
            padding-top: 15px;
            padding-bottom: 15px;
            text-decoration: none;
            font-size: 18px;
            text-align: center;
            color: black;
            display: block;
            border-bottom: 1px solid #d3d3d3;
        }
        .sidebar a:hover {
            background-color: #d3d3d3;
            color: black;
        }
        .main-content {
            margin-left: 270px;
            padding: 20px;
        }
        h2 {
            text-align: left;
            margin-bottom: 20px;
        }
        .reservation-form {
            max-width: 600px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }
        .reservation-form label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .reservation-form input,
        .reservation-form select {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #d3d3d3;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .reservation-form button {
            width: 100%;
            padding: 10px;
            background-color: #d8cef6;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        .reservation-form button:hover {
            background-color: #b4a7d6;
        }
    </style>
</head>
<body>
    <div class="header">
        예약 페이지
    </div>
    <div class="sidebar">
        <a href="userMain">HOME</a>
        <a href="userReserve">예약하기</a>
        <a href="userHome">마이페이지</a>
        <a href="notice.html">공지사항</a>
        <a href="#">...</a>
    </div>
    <div class="main-content">
        <h2>세탁기 / 건조기 예약</h2>
        <div class="reservation-form">
            <form id="reservationForm">
                <label for="machineType">기기 종류</label>
                <select id="machineType" name="machineType">
                    <option value="washer">세탁기</option>
                    <option value="dryer">건조기</option>
                </select>
                
                <label for="machineNumber">기기 번호</label>
                <select id="machineNumber" name="machineNumber">
                    <option value="1">01</option>
                    <option value="2">02</option>
                    <option value="3">03</option>
                    <option value="4">04</option>
                </select>
                
                <label for="reservationTime">예약 시간</label>
                <input type="datetime-local" id="reservationTime" name="reservationTime">
                
                <button type="button" onclick="reserveMachine()">예약하기</button>
            </form>
        </div>
    </div>
    <script>
        async function reserveMachine() {
            const machineType = document.getElementById('machineType').value;
            const machineNumber = document.getElementById('machineNumber').value;
            const reservationTime = document.getElementById('reservationTime').value;
    
            if (!reservationTime) {
                alert('날짜와 시간을 선택해 주세요.');
                return;
            }
    
            const response = await fetch('/reservations', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    usageTime: reservationTime, // 변경: 서버에서 필요한 필드 이름으로 변경
                    reservationDate: new Date().toISOString(), // 변경: 예약 생성 시 서버에서 현재 시간으로 저장하도록 변경
                    Location: machineType + " " + machineNumber // 변경: 기기 종류와 번호를 Location 필드로 합쳐서 전송
                })
            });
    
            if (response.ok) {
                const result = await response.json();
                alert(`${result.Location}이 ${result.reservationDate}에 예약되었습니다.`); // 변경: 서버에서 반환하는 필드 이름으로 변경
            } else {
                const error = await response.json();
                alert(`예약에 실패했습니다: ${error.message}`);
            }
        }
    </script>
</body>
</html>
